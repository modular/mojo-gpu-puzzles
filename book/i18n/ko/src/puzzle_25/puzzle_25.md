<!-- i18n-source-commit: 43fce1182f8029e7edc50157aed0e6ebb8129d42 -->

# Puzzle 25: Warp í†µì‹ 

## ê°œìš”

**Puzzle 25: Warp í†µì‹  ê¸°ë³¸ ìš”ì†Œ**ì—ì„œëŠ” ê³ ê¸‰ GPU **Warp ë ˆë²¨ í†µì‹  ì—°ì‚°** - Warp ë‚´ì—ì„œ íš¨ìœ¨ì ì¸ ë°ì´í„° êµí™˜ê³¼ ì¡°ì • íŒ¨í„´ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” í•˜ë“œì›¨ì–´ ê°€ì† ê¸°ë³¸ ìš”ì†Œë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. [shuffle_down](https://docs.modular.com/mojo/stdlib/gpu/warp/shuffle_down)ê³¼ [broadcast](https://docs.modular.com/mojo/stdlib/gpu/warp/broadcast)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ ê³µìœ  ë©”ëª¨ë¦¬ íŒ¨í„´ ì—†ì´ ì´ì›ƒ í†µì‹ ê³¼ ì§‘í•© ì¡°ì •ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.

**Part VII: GPU Warp í†µì‹ **ì—ì„œëŠ” ìŠ¤ë ˆë“œ ê·¸ë£¹ ë‚´ Warp ë ˆë²¨ ë°ì´í„° ì´ë™ ì—°ì‚°ì„ ë‹¤ë£¹ë‹ˆë‹¤. ë³µì¡í•œ ê³µìœ  ë©”ëª¨ë¦¬ + ì¸ë±ì‹± + ê²½ê³„ ê²€ì‚¬ íŒ¨í„´ì„ í•˜ë“œì›¨ì–´ ìµœì í™”ëœ ë°ì´í„° ì´ë™ì„ í™œìš©í•˜ëŠ” íš¨ìœ¨ì ì¸ Warp í†µì‹  í˜¸ì¶œë¡œ ëŒ€ì²´í•˜ëŠ” ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.

**í•µì‹¬ í†µì°°:** _GPU WarpëŠ” lockstepìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤ - Mojoì˜ Warp í†µì‹  ì—°ì‚°ì€ ì´ ë™ê¸°í™”ë¥¼ í™œìš©í•˜ì—¬ ìë™ ê²½ê³„ ì²˜ë¦¬ì™€ ëª…ì‹œì  ë™ê¸°í™” ì—†ì´ íš¨ìœ¨ì ì¸ ë°ì´í„° êµí™˜ ê¸°ë³¸ ìš”ì†Œë¥¼ ì œê³µí•©ë‹ˆë‹¤._

## ë°°ìš¸ ë‚´ìš©

### **Warp í†µì‹  ëª¨ë¸**

GPU Warp ë‚´ ê¸°ë³¸ í†µì‹  íŒ¨í„´ì„ ì´í•´í•©ë‹ˆë‹¤:

```
GPU Warp (32 ìŠ¤ë ˆë“œ, SIMT lockstep ì‹¤í–‰)
â”œâ”€â”€ Lane 0  â”€â”€shuffle_downâ”€â”€> Lane 1  â”€â”€shuffle_downâ”€â”€> Lane 2
â”œâ”€â”€ Lane 1  â”€â”€shuffle_downâ”€â”€> Lane 2  â”€â”€shuffle_downâ”€â”€> Lane 3
â”œâ”€â”€ Lane 2  â”€â”€shuffle_downâ”€â”€> Lane 3  â”€â”€shuffle_downâ”€â”€> Lane 4
â”‚   ...
â””â”€â”€ Lane 31 â”€â”€shuffle_downâ”€â”€> undefined (ê²½ê³„)

Broadcast íŒ¨í„´:
Lane 0 â”€â”€broadcastâ”€â”€> ëª¨ë“  Lane (0, 1, 2, ..., 31)
```

**í•˜ë“œì›¨ì–´ í˜„ì‹¤:**

- **ë ˆì§€ìŠ¤í„° ê°„ ì§ì ‘ í†µì‹ **: ë°ì´í„°ê°€ ìŠ¤ë ˆë“œ ë ˆì§€ìŠ¤í„° ì‚¬ì´ë¥¼ ì§ì ‘ ì´ë™í•©ë‹ˆë‹¤
- **ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ ì œë¡œ**: ê³µìœ  ë©”ëª¨ë¦¬ í• ë‹¹ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- **ìë™ ê²½ê³„ ì²˜ë¦¬**: í•˜ë“œì›¨ì–´ê°€ Warp ê²½ê³„ì˜ ì˜ˆì™¸ ìƒí™©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤
- **ë‹¨ì¼ ì‚¬ì´í´ ì—°ì‚°**: í•˜ë‚˜ì˜ ëª…ë ¹ ì‚¬ì´í´ì—ì„œ í†µì‹ ì´ ì™„ë£Œë©ë‹ˆë‹¤

### **Mojoì˜ Warp í†µì‹  ì—°ì‚°**

`gpu.primitives.warp`ì˜ í•µì‹¬ í†µì‹  ê¸°ë³¸ ìš”ì†Œë¥¼ ë°°ì›ë‹ˆë‹¤:

1. **[`shuffle_down(value, offset)`](https://docs.modular.com/mojo/stdlib/gpu/warp/shuffle_down)**: ë” ë†’ì€ ì¸ë±ìŠ¤ì˜ Laneì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ê¸° (ì´ì›ƒ ì ‘ê·¼)
2. **[`broadcast(value)`](https://docs.modular.com/mojo/stdlib/gpu/warp/broadcast)**: Lane 0ì˜ ê°’ì„ ëª¨ë“  Laneì— ê³µìœ  (ì¼ëŒ€ë‹¤)
3. **[`shuffle_idx(value, lane)`](https://docs.modular.com/mojo/stdlib/gpu/warp/shuffle_idx)**: íŠ¹ì • Laneì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ê¸° (ì„ì˜ ì ‘ê·¼)
4. **[`shuffle_up(value, offset)`](https://docs.modular.com/mojo/stdlib/gpu/warp/shuffle_up)**: ë” ë‚®ì€ ì¸ë±ìŠ¤ì˜ Laneì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ê¸° (ì—­ë°©í–¥ ì´ì›ƒ)

> **ì°¸ê³ :** ì´ í¼ì¦ì€ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” í†µì‹  íŒ¨í„´ì¸ `shuffle_down()`ê³¼ `broadcast()`ì— ì´ˆì ì„ ë§ì¶¥ë‹ˆë‹¤. ëª¨ë“  Warp ì—°ì‚°ì— ëŒ€í•œ ì „ì²´ ë‚´ìš©ì€ [Mojo GPU Warp ë¬¸ì„œ](https://docs.modular.com/mojo/stdlib/gpu/warp/)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

### **ì„±ëŠ¥ ë³€í™˜ ì˜ˆì‹œ**

```mojo
# ë³µì¡í•œ ì´ì›ƒ ì ‘ê·¼ íŒ¨í„´ (ê¸°ì¡´ ë°©ì‹):
shared = LayoutTensor[
    dtype,
    Layout.row_major(WARP_SIZE),
    MutAnyOrigin,
    address_space = AddressSpace.SHARED,
].stack_allocation()
shared[local_i] = input[global_i]
barrier()
if local_i < WARP_SIZE - 1:
    next_value = shared[local_i + 1]  # ì´ì›ƒ ì ‘ê·¼
    result = next_value - shared[local_i]
else:
    result = 0  # ê²½ê³„ ì²˜ë¦¬
barrier()

# Warp í†µì‹ ì€ ì´ ëª¨ë“  ë³µì¡ì„±ì„ ì œê±°í•©ë‹ˆë‹¤:
current_val = input[global_i]
next_val = shuffle_down(current_val, 1)  # ì´ì›ƒì— ì§ì ‘ ì ‘ê·¼
if lane < WARP_SIZE - 1:
    result = next_val - current_val
else:
    result = 0
```

### **Warp í†µì‹ ì´ ë¹›ë‚˜ëŠ” ìˆœê°„**

ì„±ëŠ¥ íŠ¹ì„±ì„ ì´í•´í•©ë‹ˆë‹¤:

| í†µì‹  íŒ¨í„´ | ê¸°ì¡´ ë°©ì‹ | Warp ì—°ì‚° |
|----------------------|-------------|-----------------|
| ì´ì›ƒ ì ‘ê·¼ | ê³µìœ  ë©”ëª¨ë¦¬ | ë ˆì§€ìŠ¤í„° ê°„ ì§ì ‘ í†µì‹  |
| Stencil ì—°ì‚° | ë³µì¡í•œ ì¸ë±ì‹± | ê°„ë‹¨í•œ shuffle íŒ¨í„´ |
| ë¸”ë¡ ì¡°ì • | Barrier + ê³µìœ  ë©”ëª¨ë¦¬ | ë‹¨ì¼ broadcast |
| ê²½ê³„ ì²˜ë¦¬ | ìˆ˜ë™ ê²€ì‚¬ | í•˜ë“œì›¨ì–´ ìë™ ì²˜ë¦¬ |

## ì„ ìˆ˜ ì§€ì‹

Warp í†µì‹ ì— ë“¤ì–´ê°€ê¸° ì „ì— ë‹¤ìŒ ë‚´ìš©ì— ìµìˆ™í•´ì•¼ í•©ë‹ˆë‹¤:

- **Part VII Warp ê¸°ì´ˆ**: SIMT ì‹¤í–‰ê³¼ ê¸°ë³¸ Warp ì—°ì‚°ì— ëŒ€í•œ ì´í•´ ([Puzzle 24: Warp ê¸°ì´ˆ](../puzzle_24/puzzle_24.md) ì°¸ê³ )
- **GPU ìŠ¤ë ˆë“œ ê³„ì¸µ êµ¬ì¡°**: ë¸”ë¡, Warp, Lane ë²ˆí˜¸ ë§¤ê¸°ê¸°
- **LayoutTensor ì—°ì‚°**: ë¡œë“œ, ì €ì¥, í…ì„œ ì¡°ì‘
- **ê²½ê³„ ì¡°ê±´ ì²˜ë¦¬**: ë³‘ë ¬ ì•Œê³ ë¦¬ì¦˜ì˜ ê°€ì¥ìë¦¬ ì¼€ì´ìŠ¤ ê´€ë¦¬

## í•™ìŠµ ê²½ë¡œ

### **1. shuffle_downì„ ì´ìš©í•œ ì´ì›ƒ í†µì‹ **

**â†’ [warp.shuffle_down()](./warp_shuffle_down.md)**

Stencil ì—°ì‚°ê³¼ ìœ í•œ ì°¨ë¶„ì„ ìœ„í•œ ì´ì›ƒ ê¸°ë°˜ í†µì‹  íŒ¨í„´ì„ ë°°ì›ë‹ˆë‹¤.

**ë°°ìš¸ ë‚´ìš©:**

- `shuffle_down()`ìœ¼ë¡œ ì¸ì ‘ Lane ë°ì´í„° ì ‘ê·¼í•˜ê¸°
- ìœ í•œ ì°¨ë¶„ê³¼ ì´ë™ í‰ê·  êµ¬í˜„
- Warp ê²½ê³„ ìë™ ì²˜ë¦¬
- í™•ì¥ëœ ì´ì›ƒ ì ‘ê·¼ì„ ìœ„í•œ ë‹¤ì¤‘ offset shuffle

**í•µì‹¬ íŒ¨í„´:**

```mojo
current_val = input[global_i]
next_val = shuffle_down(current_val, 1)
if lane < WARP_SIZE - 1:
    result = compute_with_neighbors(current_val, next_val)
```

### **2. broadcastë¥¼ ì´ìš©í•œ ì§‘í•© ì¡°ì •**

**â†’ [warp.broadcast()](./warp_broadcast.md)**

ë¸”ë¡ ë ˆë²¨ ì¡°ì •ê³¼ ì§‘í•©ì  ì˜ì‚¬ê²°ì •ì„ ìœ„í•œ ì¼ëŒ€ë‹¤ í†µì‹  íŒ¨í„´ì„ ë°°ì›ë‹ˆë‹¤.

**ë°°ìš¸ ë‚´ìš©:**

- `broadcast()`ë¡œ ê³„ì‚°ëœ ê°’ì„ ëª¨ë“  Laneì— ê³µìœ 
- ë¸”ë¡ ë ˆë²¨ í†µê³„ì™€ ì§‘í•©ì  ì˜ì‚¬ê²°ì • êµ¬í˜„
- broadcastì™€ ì¡°ê±´ë¶€ ë¡œì§ ê²°í•©
- ê³ ê¸‰ broadcast-shuffle ì¡°ì • íŒ¨í„´

**í•µì‹¬ íŒ¨í„´:**

```mojo
var shared_value = 0.0
if lane == 0:
    shared_value = compute_block_statistic()
shared_value = broadcast(shared_value)
result = use_shared_value(shared_value, local_data)
```

## í•µì‹¬ ê°œë…

### **í†µì‹  íŒ¨í„´**

Warp í†µì‹ ì˜ ê¸°ë³¸ íŒ¨ëŸ¬ë‹¤ì„ì„ ì´í•´í•©ë‹ˆë‹¤:

- **ì´ì›ƒ í†µì‹ **: Lane ê°„ ì¸ì ‘ ë°ì´í„° êµí™˜
- **ì§‘í•© ì¡°ì •**: í•˜ë‚˜ì˜ Laneì—ì„œ ëª¨ë“  Laneìœ¼ë¡œ ì •ë³´ ê³µìœ 
- **Stencil ì—°ì‚°**: ê³ ì •ëœ íŒ¨í„´ìœ¼ë¡œ ì´ì›ƒ ë°ì´í„° ì ‘ê·¼
- **ê²½ê³„ ì²˜ë¦¬**: Warp ê°€ì¥ìë¦¬ì—ì„œì˜ í†µì‹  ê´€ë¦¬

### **í•˜ë“œì›¨ì–´ ìµœì í™”**

Warp í†µì‹ ì´ GPU í•˜ë“œì›¨ì–´ì— ë§¤í•‘ë˜ëŠ” ë°©ì‹ì„ ì´í•´í•©ë‹ˆë‹¤:

- **ë ˆì§€ìŠ¤í„° íŒŒì¼ í†µì‹ **: ìŠ¤ë ˆë“œ ê°„ ë ˆì§€ìŠ¤í„° ì§ì ‘ ì ‘ê·¼
- **SIMT ì‹¤í–‰**: ëª¨ë“  Laneì´ í†µì‹ ì„ ë™ì‹œì— ì‹¤í–‰í•©ë‹ˆë‹¤
- **ì œë¡œ latency**: ì‹¤í–‰ ìœ ë‹› ë‚´ì—ì„œ í†µì‹ ì´ ì™„ë£Œë©ë‹ˆë‹¤
- **ìë™ ë™ê¸°í™”**: ëª…ì‹œì  barrierê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤

### **ì•Œê³ ë¦¬ì¦˜ ë³€í™˜**

ê¸°ì¡´ ë³‘ë ¬ íŒ¨í„´ì„ Warp í†µì‹ ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤:

- **ë°°ì—´ ì´ì›ƒ ì ‘ê·¼** â†’ `shuffle_down()`
- **ê³µìœ  ë©”ëª¨ë¦¬ ì¡°ì •** â†’ `broadcast()`
- **ë³µì¡í•œ ê²½ê³„ ë¡œì§** â†’ í•˜ë“œì›¨ì–´ ìë™ ì²˜ë¦¬
- **ë‹¤ë‹¨ê³„ ë™ê¸°í™”** â†’ ë‹¨ì¼ í†µì‹  ì—°ì‚°

## ì‹œì‘í•˜ê¸°

ì´ì›ƒ ê¸°ë°˜ shuffle ì—°ì‚°ìœ¼ë¡œ ê¸°ì´ˆë¥¼ ë‹¤ì§„ ë‹¤ìŒ, ê³ ê¸‰ ì¡°ì •ì„ ìœ„í•œ ì§‘í•© broadcast íŒ¨í„´ìœ¼ë¡œ ë‚˜ì•„ê°‘ë‹ˆë‹¤.

ğŸ’¡ **ì„±ê³µ íŒ**: Warp í†µì‹ ì„ ê°™ì€ Warp ë‚´ ìŠ¤ë ˆë“œ ê°„ì˜ **í•˜ë“œì›¨ì–´ ê°€ì† ë©”ì‹œì§€ íŒ¨ì‹±**ìœ¼ë¡œ ìƒê°í•˜ì„¸ìš”. ì´ ë©˜íƒˆ ëª¨ë¸ì´ GPUì˜ SIMT ì•„í‚¤í…ì²˜ë¥¼ í™œìš©í•˜ëŠ” íš¨ìœ¨ì ì¸ í†µì‹  íŒ¨í„´ìœ¼ë¡œ ì•ˆë‚´í•  ê²ƒì…ë‹ˆë‹¤.

**í•™ìŠµ ëª©í‘œ**: Puzzle 25ë¥¼ ë§ˆì¹˜ë©´, Warp í†µì‹ ì´ ë³µì¡í•œ ê³µìœ  ë©”ëª¨ë¦¬ íŒ¨í„´ì„ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” ìƒí™©ì„ ì¸ì‹í•˜ì—¬ ë” ê°„ë‹¨í•˜ê³  ë¹ ë¥¸ ì´ì›ƒ ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜ê³¼ ì¡°ì • ì•Œê³ ë¦¬ì¦˜ì„ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

**ì‹œì‘í•˜ê¸°**: **[warp.shuffle_down()](./warp_shuffle_down.md)** ì—ì„œ ì´ì›ƒ í†µì‹ ì„ ë°°ìš´ ë‹¤ìŒ, **[warp.broadcast()](./warp_broadcast.md)** ì—ì„œ ì§‘í•© ì¡°ì • íŒ¨í„´ìœ¼ë¡œ ë‚˜ì•„ê°€ì„¸ìš”.
